<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tattoo CRM — Clients · Calendar · Marketing</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
 <div class="background-fixed"></div>
  <div class="container">
  <header class="app-header glass">
    <div class="brand">
      <div class="titles">
        <h1>Tattoo CRM</h1>
        <div class="subtitle">Сегодня · Клиенты · Маркетинг · Расходники</div>
      </div>
    </div>
    <div class="header-actions">
      <button id="syncBtn" class="btn primary">
        <span class="btn-icon">⟳</span><span id="syncBtnText">Синхронизировать</span>
      </button>
    </div>
  </header>

  <main id="app">
    <!-- Стартовый мастер (вход через Google) -->
    <section id="onboarding" class="page is-active">
      <div class="card glass">
        <h2>Добро пожаловать</h2>
        <p>Войдите через Google, чтобы хранить клиентов, записи и фото в Firestore и Google Drive.</p>

        <div class="y-16"></div>
        <button id="bootstrapBtn" class="btn success wide">Войти через Google</button>

        <div class="y-12"></div>
        <button id="demoBtn" class="btn ghost">Запустить демо</button>
      </div>
    </section>

    <!-- Вкладка: Сегодня -->
    <section id="todayPage" class="page">
      <div class="section">
        <h2>Сегодня</h2>
        <div id="todaySchedule" class="list"></div>
      </div>
      <div class="section">
        <h3>Напоминания</h3>
        <div id="todayReminders" class="list"></div>
      </div>
    </section>

    <!-- Вкладка: Клиенты -->
    <section id="clientsPage" class="page">
      <div class="toolbar glass">
        <input id="searchInput" class="search" placeholder="Поиск: имя, телефон, стиль…" />
        <button id="addClientBtn" class="btn success">+ Клиент</button>
      </div>

      <div class="filters-row">
        <select id="filterSource" class="chip">
          <option value="">Источник: все</option>
        </select>
        <select id="filterStatus" class="chip">
          <option value="">Статус: все</option>
          <option>Лид</option><option>Консультация</option>
          <option>Сеанс</option><option>Отменил</option><option>Слился</option>
        </select>
      </div>

      <div id="clientsList" class="cards-grid"></div>

      <!-- Карточка клиента (модал) -->
      <dialog id="clientDialog" class="modal">
        <form method="dialog" class="modal-body glass">
          <div class="modal-head">
            <h3 id="clientModalTitle">Клиент</h3>
            <button class="btn icon" value="cancel" title="Закрыть">✕</button>
          </div>

          <div class="grid two">
            <label class="field"><span>Имя</span><input id="fName" /></label>
            <label class="field"><span>Телефон</span><input id="fPhone" /></label>
            <label class="field"><span>Контакт (ссылка)</span><input id="fLink" placeholder="instagram / tg / vk ссылка"/></label>
            <label class="field"><span>Источник</span><select id="fSource"></select></label>
            <label class="field"><span>Первая тату?</span>
              <select id="fFirst"><option value="true">Да</option><option value="false">Нет</option></select>
            </label>
            <label class="field"><span>Тип</span>
              <select id="fType">
                <option>Новая</option><option>Перекрытие</option><option>Коррекция</option>
              </select>
            </label>
            <label class="field"><span>Стиль (теги)</span><input id="fStyles" placeholder="realism, ч/б"/></label>
            <label class="field"><span>Зоны</span><input id="fZones" placeholder="forearm, calf"/></label>
            <label class="field"><span>Статус</span>
              <select id="fStatus">
                <option>Лид</option><option>Консультация</option><option>Сеанс</option>
                <option>Отменил</option><option>Слился</option>
              </select>
            </label>
            <label class="field"><span>Квалификация</span>
              <select id="fQual"><option>Целевой</option><option>Условно целевой</option><option>Нецелевой</option></select>
            </label>
            <label class="field"><span>Депозит (€)</span><input id="fDeposit" type="number" step="1"/></label>
            <label class="field"><span>Сумма (€)</span><input id="fAmount" type="number" step="1"/></label>
            <label class="field"><span>Дата сеанса</span><input id="fNextDate" type="datetime-local" /></label>
<label class="field"><span>Напоминание</span>
  <div class="row gap-8">
    <select id="fReminderTpl" class="chip" style="flex:1">
      <option value="">— шаблон —</option>
    </select>
    <select id="fReminderAfter" class="chip" title="Когда напомнить">
      <option value="">дни</option>
    </select>
  </div>
  <input id="fReminderTitle" placeholder="Свой текст напоминания (необязательно)"/>
</label>

          </div>

          <label class="field"><span>Заметка</span><textarea id="fNotes" rows="3" placeholder="особенности, пожелания…"></textarea></label>

          <div class="panel">
            <div class="stack">
              <div class="subtle">Фото</div>
              <div id="photosEmptyNote" class="empty-note">У этого клиента пока нет фотографий.</div>
              <div class="row gap-8">
                <input id="photoInput" type="file" multiple accept="image/*" hidden/>
                <button id="attachPhotosBtn" class="btn">+ Прикрепить фотографии</button>
                <button id="openFolderBtn" class="btn ghost">Открыть папку</button>
                <button id="shareFolderBtn" class="btn ghost">Поделиться папкой</button>
              </div>

<div id="photosGrid" class="thumbs-grid"></div>

           
 </div>
          </div>

          <div class="modal-foot">
            <button class="btn danger" id="deleteClientBtn" type="button">Удалить</button>
            <div class="spacer"></div>
            <button class="btn" value="cancel">Отмена</button>
            <button class="btn primary" id="saveClientBtn" type="button">Сохранить</button>
          </div>
        </form>
      </dialog>
    </section>

    <!-- Вкладка: Маркетинг -->
    <section id="marketingPage" class="page">
      <div class="section">
        <h2>Маркетинг (за период)</h2>
        <div id="mkHighlites" class="metrics-grid"></div>
        <div id="mkTable" class="table glass"></div>
        <div class="export-row">
          <button class="btn">Экспорт CSV</button>
          <button class="btn">Экспорт XLSX</button>
          <button class="btn">Экспорт графика (PNG)</button>
          <button class="btn">Экспорт PDF</button>
        </div>
      </div>
    </section>

    <!-- Вкладка: Расходники -->
    <section id="suppliesPage" class="page">
      <div class="toolbar glass">
        <select id="supFilter" class="chip">
          <option value="">Категория: все</option>
        </select>
        <button id="addSupplyBtn" class="btn">+ Позиция</button>
      </div>
      <div id="suppliesList" class="cards-grid"></div>
    </section>

    <!-- Вкладка: Настройки -->
    <section id="settingsPage" class="page">
      <div class="section">
        <h2>Настройки</h2>
        <div class="grid two">
          <label class="field"><span>Источники клиентов</span>
            <textarea id="setSources" rows="2" placeholder="Instagram, TikTok, VK, Сарафан"></textarea>
          </label>
          <label class="field"><span>Стили (теги)</span>
            <textarea id="setStyles" rows="2" placeholder="Реализм, Ч/Б, Цвет"></textarea>
          </label>
          <label class="field"><span>Зоны тела</span>
            <textarea id="setZones" rows="2" placeholder="Рука, Нога, Спина"></textarea>
          </label>
          <label class="field"><span>Категории расходников</span>
            <textarea id="setSupplies" rows="2" placeholder="Краски, Иглы, Химия"></textarea>
          </label>
          <label class="field"><span>Напоминание по умолчанию</span>
            <input id="setDefaultReminder" placeholder="Через 14 дней — Спросить про заживление">
          </label>
<label class="field"><span>Шаблоны напоминаний</span>
  <textarea id="setReminderTemplates" rows="2" placeholder="Попросить отзыв, Спросить про заживление, Отправить инструкции по уходу"></textarea>
</label>
<label class="field"><span>Шаблоны сроков (дни)</span>
  <input id="setReminderDelays" placeholder="14, 30, 180"/>
</label>

<div class="row">
  <button id="btnConnectDrive" class="btn primary">Подключить Google Drive</button>
  <span id="driveStatus" class="chip">Drive: оффлайн</span>
</div>
          <label class="field"><span>Интервал авто-синхронизации (сек)</span>
            <input id="setSyncInterval" type="number" min="15" step="15" />
          </label>
        </div>
        <div class="y-12"></div>
        <div class="row gap-8">
          <button id="saveSettingsBtn" class="btn primary">Сохранить настройки</button>
          <button id="logoutBtn" class="btn danger ghost">Выйти из аккаунта</button>
        </div>
      </div>
    </section>
  </main>

  <nav class="tabbar glass">
    <button data-tab="todayPage" class="tab is-active">Сегодня</button>
    <button data-tab="clientsPage" class="tab">Клиенты</button>
    <button data-tab="marketingPage" class="tab">Маркетинг</button>
    <button data-tab="suppliesPage" class="tab">Расходники</button>
    <button data-tab="settingsPage" class="tab">Настройки</button>
  </nav>

  <div id="toast" class="toast"></div>

<!-- Boot overlay -->
<div id="bootOverlay" class="boot hidden">
  <div class="boot-box glass">
    <div class="boot-head">
      <b>Загрузка приложения…</b>
      <span id="bootProgress">0%</span>
    </div>
    <div id="bootSteps" class="boot-steps"></div>
    <div id="bootHint" class="boot-hint"></div>
  </div>
</div>


  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore-compat.js"></script>

<!-- Google Identity Services (для бесшумного обновления access_token) -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <!-- Google API (Drive) -->
  <script src="https://apis.google.com/js/api.js"></script>
  <!-- Твой конфиг Firebase -->
  <script src="./firebase-config.js"></script>

  <!-- Модуль для работы с Google Drive -->
  <script src="./drive.js"></script>

  <!-- Приложение -->
  <script src="./app.js?v=5"></script>
</div> <!-- .container -->
</body>
</html>
